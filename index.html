<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Estructura de Nodos y Elementos • A-Frame</title>
    <meta name="description" content="Visualización 3D de estructura con nodos y elementos conectados">
    <script src="https://aframe.io/releases/1.7.1/aframe.min.js"></script>
    <script>
      // ESCALA DE LA ESTRUCTURA - Cambiar aquí para escalar toda la estructura
      const ESCALA = 0.1; // Factor de escala (0.1 = 10% del tamaño original)
      
      // Aplicar escala cuando cargue la página
      window.addEventListener('DOMContentLoaded', function() {
        const estructura = document.getElementById('estructura-principal');
        const camara = document.getElementById('camara-principal');
        
        // Aplicar la escala a la estructura
        estructura.setAttribute('scale', `${ESCALA} ${ESCALA} ${ESCALA}`);
        
        // Calcular posición de cámara basada en la escala
        const Lv1 = 3, Lh1 = 4;
        const dimensionX = Lh1 * 2 * ESCALA;
        const dimensionY = Lv1 * 2 * ESCALA;
        const centroX = dimensionX / 2;
        const centroY = dimensionY / 2;
        
        // Ajustar cámara para vista desde arriba y lejos
        const distanciaOptima = Math.max(dimensionX, dimensionY) * 8;
        const alturaOptima = dimensionY * 3;
        
        camara.setAttribute('position', `${centroX} ${alturaOptima} ${distanciaOptima}`);
        camara.setAttribute('look-at', `${centroX} ${centroY} 0`);
        
        console.log(`Escala aplicada: ${ESCALA}`);
        console.log(`Dimensiones escaladas: ${dimensionX.toFixed(3)} x ${dimensionY.toFixed(3)}`);
        console.log(`Posición cámara: [${centroX.toFixed(3)}, ${alturaOptima.toFixed(3)}, ${distanciaOptima.toFixed(3)}]`);
      });
    </script>
    <style>
      body {
        margin: 0;
        font-family: Arial, sans-serif;
      }
      .info {
        position: absolute;
        top: 10px;
        left: 10px;
        background: rgba(0,0,0,0.8);
        color: white;
        padding: 15px;
        border-radius: 5px;
        font-size: 12px;
        z-index: 1000;
        max-width: 300px;
      }
      .controls {
        position: absolute;
        bottom: 10px;
        left: 10px;
        background: rgba(0,0,0,0.8);
        color: white;
        padding: 10px;
        border-radius: 5px;
        font-size: 11px;
        z-index: 1000;
      }
      .deformation-control {
        position: absolute;
        top: 10px;
        right: 10px;
        background: rgba(0,0,0,0.8);
        color: white;
        padding: 15px;
        border-radius: 5px;
        font-size: 12px;
        z-index: 1000;
        text-align: center;
      }
      .deformation-control button {
        padding: 10px 20px;
        background: #4488ff;
        color: white;
        border: none;
        border-radius: 5px;
        cursor: pointer;
        font-size: 14px;
        font-weight: bold;
        transition: all 0.3s ease;
      }
      .deformation-control button:hover {
        transform: scale(1.05);
        box-shadow: 0 4px 8px rgba(0,0,0,0.3);
      }
    </style>
  </head>
  <body>
    <div class="info">
      <h3>Estructura de Nodos y Elementos</h3>
      <p><strong>Nodos:</strong> 8 (esferas rojas)</p>
      <p><strong>Elementos:</strong> 8 (líneas azules)</p>
      <p><strong>Escala:</strong> 1.0 (tamaño original)</p>
      <p><strong>Dimensiones:</strong> 8m × 6m</p>
      <p><strong>Amplificación:</strong> 10,000x</p>
    </div>
    
    <div class="deformation-control">
      <button id="btn-deformacion" onclick="toggleDeformacion()">Mostrar Deformada</button>
      <p><small>Los desplazamientos están amplificados para visualización</small></p>
    </div>
    
    <div class="controls">
      <strong>Controles:</strong><br>
      Mouse: Rotar vista | WASD: Moverse | VR: Botón inferior derecho
    </div>

    <a-scene background="color: #f0f0f0" 
             cursor="rayOrigin: mouse">
      
      <!-- Iluminación -->
      <a-light type="ambient" color="#404040"></a-light>
      <a-light type="directional" position="2 4 2" color="#ffffff" intensity="0.8"></a-light>
      
      <!-- Entidad principal que contiene toda la estructura -->
      <a-entity id="estructura-principal">
        
        <!-- Plano de referencia (suelo) -->
        <a-plane position="4 -1 0" 
                 rotation="-90 0 0" 
                 width="12" 
                 height="8" 
                 color="#e8e8e8" 
                 opacity="0.7"
                 shadow="receive: true"></a-plane>
        
        <!-- Grid de referencia -->
        <a-entity id="grid">
          <!-- Líneas verticales -->
          <a-cylinder position="0 3 -0.1" radius="0.05" height="6" color="#cccccc" opacity="0.3"></a-cylinder>
          <a-cylinder position="4 3 -0.1" radius="0.05" height="6" color="#cccccc" opacity="0.3"></a-cylinder>
          <a-cylinder position="8 3 -0.1" radius="0.05" height="6" color="#cccccc" opacity="0.3"></a-cylinder>
          <!-- Líneas horizontales -->
          <a-cylinder position="4 0 -0.1" radius="0.05" height="8" rotation="0 0 90" color="#cccccc" opacity="0.3"></a-cylinder>
          <a-cylinder position="4 3 -0.1" radius="0.05" height="8" rotation="0 0 90" color="#cccccc" opacity="0.3"></a-cylinder>
          <a-cylinder position="4 6 -0.1" radius="0.05" height="8" rotation="0 0 90" color="#cccccc" opacity="0.3"></a-cylinder>
        </a-entity>

        <!-- NODOS (Esferas) -->
        <!-- Nodo 1: [0,0] -->
        <a-sphere id="nodo-1" position="0 0 0" 
                  radius="0.8" 
                  color="#ff4444" 
                  shadow="cast: true"
                  animation="property: rotation; to: 0 360 0; loop: true; dur: 10000">
          <a-text value="1" position="0 1.5 0" align="center" color="#000" scale="10 10 10"></a-text>
        </a-sphere>
        
        <!-- Nodo 2: [0,3] -->
        <a-sphere id="nodo-2" position="0 3 0" 
                  radius="0.8" 
                  color="#ff4444" 
                  shadow="cast: true"
                  animation="property: rotation; to: 0 360 0; loop: true; dur: 10000">
          <a-text value="2" position="0 1.5 0" align="center" color="#000" scale="10 10 10"></a-text>
        </a-sphere>
        
        <!-- Nodo 3: [0,6] -->
        <a-sphere id="nodo-3" position="0 6 0" 
                  radius="0.8" 
                  color="#ff4444" 
                  shadow="cast: true"
                  animation="property: rotation; to: 0 360 0; loop: true; dur: 10000">
          <a-text value="3" position="0 1.5 0" align="center" color="#000" scale="10 10 10"></a-text>
        </a-sphere>
        
        <!-- Nodo 4: [4,6] -->
        <a-sphere id="nodo-4" position="4 6 0" 
                  radius="0.8" 
                  color="#ff4444" 
                  shadow="cast: true"
                  animation="property: rotation; to: 0 360 0; loop: true; dur: 10000">
          <a-text value="4" position="0 1.5 0" align="center" color="#000" scale="10 10 10"></a-text>
        </a-sphere>
        
        <!-- Nodo 5: [4,3] -->
        <a-sphere id="nodo-5" position="4 3 0" 
                  radius="0.8" 
                  color="#ff4444" 
                  shadow="cast: true"
                  animation="property: rotation; to: 0 360 0; loop: true; dur: 10000">
          <a-text value="5" position="0 1.5 0" align="center" color="#000" scale="10 10 10"></a-text>
        </a-sphere>
        
        <!-- Nodo 6: [4,0] -->
        <a-sphere id="nodo-6" position="4 0 0" 
                  radius="0.8" 
                  color="#ff4444" 
                  shadow="cast: true"
                  animation="property: rotation; to: 0 360 0; loop: true; dur: 10000">
          <a-text value="6" position="0 1.5 0" align="center" color="#000" scale="10 10 10"></a-text>
        </a-sphere>
        
        <!-- Nodo 7: [8,3] -->
        <a-sphere id="nodo-7" position="8 3 0" 
                  radius="0.8" 
                  color="#ff4444" 
                  shadow="cast: true"
                  animation="property: rotation; to: 0 360 0; loop: true; dur: 10000">
          <a-text value="7" position="0 1.5 0" align="center" color="#000" scale="10 10 10"></a-text>
        </a-sphere>
        
        <!-- Nodo 8: [8,0] -->
        <a-sphere id="nodo-8" position="8 0 0" 
                  radius="0.8" 
                  color="#ff4444" 
                  shadow="cast: true"
                  animation="property: rotation; to: 0 360 0; loop: true; dur: 10000">
          <a-text value="8" position="0 1.5 0" align="center" color="#000" scale="10 10 10"></a-text>
        </a-sphere>

        <!-- ELEMENTOS (Líneas/Cilindros conectando nodos) -->
        <!-- Elemento 1: Nodo 1-2 [0,0] to [0,3] -->
        <a-cylinder position="0 1.5 0" 
                    radius="0.15" 
                    height="3" 
                    color="#4488ff"
                    animation="property: material.color; to: #88bbff; dir: alternate; loop: true; dur: 2000">
          <a-text value="E1" position="3 0 0" align="center" color="#0066cc" scale="8 8 8"></a-text>
        </a-cylinder>
        
        <!-- Elemento 2: Nodo 2-3 [0,3] to [0,6] -->
        <a-cylinder position="0 4.5 0" 
                    radius="0.15" 
                    height="3" 
                    color="#4488ff"
                    animation="property: material.color; to: #88bbff; dir: alternate; loop: true; dur: 2000; delay: 200">
          <a-text value="E2" position="3 0 0" align="center" color="#0066cc" scale="8 8 8"></a-text>
        </a-cylinder>
        
        <!-- Elemento 3: Nodo 3-4 [0,6] to [4,6] -->
        <a-cylinder position="2 6 0" 
                    radius="0.15" 
                    height="4" 
                    rotation="0 0 90" 
                    color="#4488ff"
                    animation="property: material.color; to: #88bbff; dir: alternate; loop: true; dur: 2000; delay: 400">
          <a-text value="E3" position="0 3 0" align="center" color="#0066cc" scale="8 8 8"></a-text>
        </a-cylinder>
        
        <!-- Elemento 4: Nodo 4-5 [4,6] to [4,3] -->
        <a-cylinder position="4 4.5 0" 
                    radius="0.15" 
                    height="3" 
                    color="#4488ff"
                    animation="property: material.color; to: #88bbff; dir: alternate; loop: true; dur: 2000; delay: 600">
          <a-text value="E4" position="3 0 0" align="center" color="#0066cc" scale="8 8 8"></a-text>
        </a-cylinder>
        
        <!-- Elemento 5: Nodo 2-5 [0,3] to [4,3] -->
        <a-cylinder position="2 3 0" 
                    radius="0.15" 
                    height="4" 
                    rotation="0 0 90" 
                    color="#4488ff"
                    animation="property: material.color; to: #88bbff; dir: alternate; loop: true; dur: 2000; delay: 800">
          <a-text value="E5" position="0 3 0" align="center" color="#0066cc" scale="8 8 8"></a-text>
        </a-cylinder>
        
        <!-- Elemento 6: Nodo 5-6 [4,3] to [4,0] -->
        <a-cylinder position="4 1.5 0" 
                    radius="0.15" 
                    height="3" 
                    color="#4488ff"
                    animation="property: material.color; to: #88bbff; dir: alternate; loop: true; dur: 2000; delay: 1000">
          <a-text value="E6" position="3 0 0" align="center" color="#0066cc" scale="8 8 8"></a-text>
        </a-cylinder>
        
        <!-- Elemento 7: Nodo 5-7 [4,3] to [8,3] -->
        <a-cylinder position="6 3 0" 
                    radius="0.15" 
                    height="4" 
                    rotation="0 0 90" 
                    color="#4488ff"
                    animation="property: material.color; to: #88bbff; dir: alternate; loop: true; dur: 2000; delay: 1200">
          <a-text value="E7" position="0 3 0" align="center" color="#0066cc" scale="8 8 8"></a-text>
        </a-cylinder>
        
        <!-- Elemento 8: Nodo 7-8 [8,3] to [8,0] -->
        <a-cylinder position="8 1.5 0" 
                    radius="0.15" 
                    height="3" 
                    color="#4488ff"
                    animation="property: material.color; to: #88bbff; dir: alternate; loop: true; dur: 2000; delay: 1400">
          <a-text value="E8" position="3 0 0" align="center" color="#0066cc" scale="8 8 8"></a-text>
        </a-cylinder>

        <!-- Texto informativo en 3D -->
        <a-text position="4 8 0" 
                value="Estructura de Nodos y Elementos" 
                align="center" 
                color="#333333" 
                scale="6 6 6"
                animation="property: rotation; to: 0 360 0; loop: true; dur: 20000"></a-text>
        
        <!-- Ejes de coordenadas -->
        <a-entity id="ejes" position="-2 -2 0">
          <!-- Eje X (rojo) -->
          <a-cylinder position="1 0 0" radius="0.1" height="2" rotation="0 0 90" color="#ff0000"></a-cylinder>
          <a-text value="X" position="2.5 0 0" color="#ff0000" scale="4 4 4"></a-text>
          
          <!-- Eje Y (verde) -->
          <a-cylinder position="0 1 0" radius="0.1" height="2" color="#00ff00"></a-cylinder>
          <a-text value="Y" position="0 2.5 0" color="#00ff00" scale="4 4 4"></a-text>
          
          <!-- Eje Z (azul) -->
          <a-cylinder position="0 0 1" radius="0.1" height="2" rotation="90 0 0" color="#0000ff"></a-cylinder>
          <a-text value="Z" position="0 0 2.5" color="#0000ff" scale="4 4 4"></a-text>
        </a-entity>
      </a-entity>
      
      <!-- Cámara posicionada dinámicamente -->
      <a-camera id="camara-principal" 
                wasd-controls="acceleration: 5">
      </a-camera>
    </a-scene>

    <script>
      // Inicialización simple - la escala ya está aplicada en el HTML
      console.log('Estructura cargada con funcionalidad de deformación');
    </script>
  </body>
</html>
